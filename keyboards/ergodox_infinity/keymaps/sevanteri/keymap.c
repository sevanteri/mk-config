/* vim: set fdm=marker */
// Nordic layout for Ergodox infinity

#include QMK_KEYBOARD_H
#include "debug.h"
#include "action_layer.h"
#include "action.h"
#include "version.h"
#include "keymap_swedish.h"
#include "sevanteri.h"
#include "process_combo.h"
#include "wrappers.h"


const uint16_t PROGMEM keymaps[][MATRIX_ROWS][MATRIX_COLS] = {
/* Basic layer {{{
 *
 *
 * ,--------------------------------------------------.           ,--------------------------------------------------.
 * |  ISO/  |   1  |   2  |   3  |   4  |   5  |      |           |      |   6  |   7  |   8  |   9  |   0  |   +    |
 * |--------+------+------+------+------+-------------|           |------+------+------+------+------+------+--------|
 * |  Tab   |   Q  |   W  |   E  |   R  |   T  |  ¨^  |           |  Å   |   Y  |   U  |   I  |   O  |   P  |   '    |
 * |--------+------+------+------+------+------|      |           |      |------+------+------+------+------+--------|
 * |  ESC   |   A  |   S  |   D  |   F  |   G  |------|           |------|   H  |   J  |   K  |   L  |   Ö  |   Ä    |
 * |--------+------+------+------+------+------| DEL  |           | BSPC |------+------+------+------+------+--------|
 * | LShift<|   Z  |   X  |   C  |   V  |   B  |      |           |      |   N  |   M  |   ,  |   .  |  -   | RShift |
 * `--------+------+------+------+------+-------------'           `-------------+------+------+------+------+--------'
 *   | Ctrl |  ´`  |  §½  | RBTN | LBTN |                                       | SYMB | PRSC | INS  | RALT | SWAP |
 *   `----------------------------------'                                       `----------------------------------'
 *                                        ,-------------.       ,-------------.
 *                                        | HOME | END  |       | PgUp |RCTRL |
 *                                 ,------+------+------|       |------+--------+------.
 *                                 | LATL |      |FUNCL |       | PgDn |  FUNC  | Shift|
 *                                 | Space| BSPC |------|       |------|  Enter | Space|
 *                                 |      |      | LCTRL|       |FUNCL |        |      |
 *                                 `--------------------'       `----------------------'
 */

// layer 0 : default
[_BASE] = LAYOUT_ergodox_pretty_wrapper(

    SE_SECT,  _________________SYMB_L1___________________, TG(_GAME),   /*****/ _______,  _________________SYMB_R1___________________, SE_PLUS,
    KC_TAB,   _________________QWERTY_L1_________________, SE_DIAE,   /*****/ SE_ARNG,  _________________QWERTY_R1_________________, SE_QUOT,
    KC_ESC,   _________________QWERTY_L2_________________, /**/       /*****/ /**/      _________________QWERTY_R2_________________, MY_AE,
    KC_LSFT,  _________________QWERTY_L3_________________, KC_DEL,    /*****/ KC_BSPC,  _________________QWERTY_R3_________________, KC_RSFT,
    KC_NO,   SE_ACUT, _______, ____QWERTY_L4___, /******/ /******/   /*****/ ____QWERTY_R4___, KC_INS, KC_RALT,  KC_NO,

    /******/  /******/ /******/ /******/ /******/ TD_HEMD, KC_END,    /*****/ KC_PGUP,   KC_RCTRL,
    /******/  /******/ /******/ /******/ /******/ /******/ _______,   /*****/ KC_PGDN,
    /******/  /******/ /******/ /******/ _QWERTY_THUMBL__, KC_LCTRL,  /*****/ MO(_FUNC), _QWERTY_THUMBR__

),
// }}}
/* Number and symbol layer {{{
 *
 *
 *
 * ,--------------------------------------------------.           ,--------------------------------------------------.
 * |        |      |      |      |      |      |      |           |      |      |      |      |      |      |        |
 * |--------+------+------+------+------+-------------|           |------+------+------+------+------+------+--------|
 * |   §    |  1   |  2   |  3   |  4   |  5   |  ~   |           |      |  6   |  7   |  8   |  9   |  0   |   +    |
 * |--------+------+------+------+------+------|      |           |      |------+------+------+------+------+--------|
 * |   ½    |  !   |  "   |  #   |  ¤   |  %   |------|           |------|  &   |  /   |  (   |  )   |  =   |   ?    |
 * |--------+------+------+------+------+------|      |           |      |------+------+------+------+------+--------|
 * |   /    |      |  @   |  £   |  $   |  ‰   |      |           |      |  ‚   |  {   |  [   |  ]   |  }   |   \    |
 * `--------+------+------+------+------+-------------'           `-------------+------+------+------+------+--------'
 *   |      |      |       |     | CODE |                                       |      |  ´   |      |      |      |
 *   `----------------------------------'                                       `----------------------------------'
 *                                        ,-------------.       ,-------------.
 *                                        |      |      |       |      |      |
 *                                 ,------+------+------|       |------+--------+------.
 *                                 |      |      |      |       |      |        |      |
 *                                 |  .   |      |------|       |------|        |      |
 *                                 |      |      |      |       |      |        |      |
 *                                 `--------------------'       `----------------------'
 */

// number and symbol layer
[_SYMB] = LAYOUT_ergodox_pretty_wrapper(

    _______,       _______, _______, _______, _______, _______, _______,       /*****/ _______, _______, _______, _______, _______, _______, _______,
    SE_SECT,       _________________SYMB_L1___________________, RALT(SE_DIAE), /*****/ _______, _________________SYMB_R1___________________, SE_PLUS,
    LSFT(SE_SECT), _________________SYMB_L2___________________, /******/       /*****/ /******/ _________________SYMB_R2___________________, LSFT(SE_PLUS),
    RALT(SE_SECT), _________________SYMB_L3___________________, _______,       /*****/ _______, _________________SYMB_R3___________________, RALT(SE_PLUS),
    _______,       _______, _______, ____SYMB_L4_____, /******/ /******/       /*****/ /******/ /******/ ____SYMB_R4_____, _______, _______, _______,

    /******/       /******/ /******/ /******/ /******/ _______, _______,       /*****/ _______, _______,
    /******/       /******/ /******/ /******/ /******/ /******/ _______,       /*****/ _______,
    /******/       /******/ /******/ /******/ ___SYMB_THUMBL__, _______,       /*****/ _______, ___SYMB_THUMBR__

),
// }}}
/* Function layer {{{
 *
 *
 *
 * ,--------------------------------------------------.           ,--------------------------------------------------.
 * |        |      |      |      |      |      |      |           |      |      |      |      |      |      |        |
 * |--------+------+------+------+------+-------------|           |------+------+------+------+------+------+--------|
 * |        |  F1  |  F2  |  F3  |  F4  |      | GAME |           |      |BRBAK | CTAB |CSTAB |BRFWD |VOLUP |        |
 * |--------+------+------+------+------+------|      |           |      |------+------+------+------+------+--------|
 * |        |  F5  |  F6  |  F7  |  F8  |      |------|           |------| LEFT | DOWN |  UP  |RIGHT |VOLDN |        |
 * |--------+------+------+------+------+------|      |           |      |------+------+------+------+------+--------|
 * |        |  F9  |  F10 |  F11 |  F12 |      |      |           |      | MLEFT| MDOWN| MUP  |MRIGHT| PLAY |        |
 * `--------+------+------+------+------+-------------'           `-------------+------+------+------+------+--------'
 *   |      |      |       |     |      |                                       |      |      |      |      |      |
 *   `----------------------------------'                                       `----------------------------------'
 *                                        ,-------------.       ,-------------.
 *                                        |      |BLTOG |       |      |      |
 *                                 ,------+------+------|       |------+--------+------.
 *                                 |      |      | BL+  |       |      |        |      |
 *                                 |      |      |------|       |------|        |      |
 *                                 |      |      | BL-  |       |      |        |      |
 *                                 `--------------------'       `----------------------'
 */

// layer 1 : functions
[_FUNC] = LAYOUT_ergodox_pretty_wrapper(

    _______, _______, _______, _______, _______, _______, _______,  /*****/ _______, _______, _______, _______, _______, _______, _______,
    _______, _________________FUNCL_L1__________________, TG(_GAME), /*****/ _______, _________________FUNCL_R1__________________, _______,
    _______, _________________FUNCL_L2__________________, /******/  /*****/ /******/ _________________FUNCL_R2__________________, _______,
    _______, _________________FUNCL_L3__________________, _______,  /*****/ _______, _________________FUNCL_R3__________________, _______,
    _______, _______, _______, ____FUNC_L4_____, /******/ /******/  /*****/ /******/ /******/ ____FUNC_R4_____, _______,  _______, _______,

    /******/ /******/ /******/ /******/ /******/ _______, BL_TOGG,  /*****/ _______, _______,
    /******/ /******/ /******/ /******/ /******/ /******/ BL_INC,   /*****/ _______,
    /******/ /******/ /******/ /******/ ___FUNC_THUMBL__, BL_DEC,   /*****/ _______, ___FUNC_THUMBR__

),
// }}}
/* Gaming {{{
 *
 *
 *
 * ,--------------------------------------------------.           ,--------------------------------------------------.
 * | ESC    |      |      |      |      |      |      |           |      |      |      |      |      |      | RESET  |
 * |--------+------+------+------+------+-------------|           |------+------+------+------+------+------+--------|
 * |        |      |      |      |      |      |      |           |      |      |      |      |      |      |        |
 * |--------+------+------+------+------+------|      |           |      |------+------+------+------+------+--------|
 * | LCTRL  |      |      |      |      |      |------|           |------|      |      |      |      |      |        |
 * |--------+------+------+------+------+------|      |           |      |------+------+------+------+------+--------|
 * |        |      |      |      |      |      |      |           |      |      |      |      |      |      |        |
 * `--------+------+------+------+------+-------------'           `-------------+------+------+------+------+--------'
 *   |      |      |       |     |      |                                       |      |      |      |      |      |
 *   `----------------------------------'                                       `----------------------------------'
 *                                        ,-------------.       ,-------------.
 *                                        |      |      |       |      |      |
 *                                 ,------+------+------|       |------+--------+------.
 *                                 | Space| Space|      |       |      |        |      |
 *                                 |      |      |------|       |------|        |      |
 *                                 |      |      |      |       |      |        |      |
 *                                 `--------------------'       `----------------------'
 */

// gaming layer
[_GAME] = LAYOUT_ergodox_pretty_wrapper(

    KC_ESC,    _______,  _______,  _______,  _______,  _______,  TG(_GAME),   /*****/  _______,  _______,  _______,  _______,  _______,  _______,  _______,
    KC_TAB,    KC_Q,     KC_W,     KC_E,     KC_R,     KC_T,     _______,  /*****/  _______,  _______,  _______,  _______,  _______,  _______,  _______,
    KC_LCTRL,  KC_A,     KC_S,     KC_D,     KC_F,     KC_G,     /**/       /*****/  /**/      _______,  _______,  _______,  _______,  _______,  _______,
    KC_LSFT,   KC_Z,     KC_X,     KC_C,     KC_V,     KC_B,     KC_LALT,   /*****/  KC_BSPC,  _______,  _______,  _______,  _______,  _______,  _______,
    SE_ARNG,   _______,  _______,  KC_BTN2,  KC_BTN1,  /**/      /**/       /*****/  /**/      /**/      _______,  _______,  _______,  _______,  KC_RGUI,

    /**/      /**/     /**/     /**/     /**/     _______, _______, /*****/ _______, _______,
    /**/      /**/     /**/     /**/     /**/     /**/     KC_BTN3, /*****/ _______,
    /**/      /**/     /**/     /**/     KC_SPC,  KC_LSFT,  _______, /*****/ _______, KC_ENT, _______

)
// }}}
/* Mouse {{{
 *
 *
 *
 * ,--------------------------------------------------.           ,--------------------------------------------------.
 * |        |      |      |      |      |      |      |           |      |      |      |      |      |      |        |
 * |--------+------+------+------+------+-------------|           |------+------+------+------+------+------+--------|
 * |        |      |      |      |      |      |      |           |      |      |      |      |      |      |        |
 * |--------+------+------+------+------+------|      |           |      |------+------+------+------+------+--------|
 * |        |      |      |      |      |      |------|           |------|      |      |      |      |      |        |
 * |--------+------+------+------+------+------|      |           |      |------+------+------+------+------+--------|
 * |        |      |      |      |      |      |      |           |      |      |      |      |      |      |        |
 * `--------+------+------+------+------+-------------'           `-------------+------+------+------+------+--------'
 *   |      |      |       |     |      |                                       |      |      |      |      |      |
 *   `----------------------------------'                                       `----------------------------------'
 *                                        ,-------------.       ,-------------.
 *                                        |      |      |       |      |      |
 *                                 ,------+------+------|       |------+--------+------.
 *                                 |      |      |      |       |      |        |      |
 *                                 |      |      |------|       |------|        |      |
 *                                 |      |      |      |       |      |        |      |
 *                                 `--------------------'       `----------------------'
 */
,[_MOUS] = LAYOUT_ergodox_pretty_wrapper(

    _______,  _______, _______, _______, _______, _______, _______, /*****/ _______, _______, _______, _______, _______, _______, _______,
    _______,  _______, _______, _______, _______, _______, _______, /*****/ _______, _______, _______, _______, _______, _______, _______,
    _______,  _______, _______, _______, _______, _______, /**/     /*****/ /**/     _________________MOUS_R2___________________, _______,
    _______,  _______, _______, _______, _______, _______, _______, /*****/ _______, _________________MOUS_R3___________________, _______,
    _______,  _______, _______, _______, _______, /**/     /**/     /*****/ /**/     /**/     ____MOUS_R4_____, _______, _______, _______,

    /**/      /**/     /**/     /**/     /**/     _______, _______, /*****/ _______, _______,
    /**/      /**/     /**/     /**/     /**/     /**/     _______, /*****/ _______,
    /**/      /**/     /**/     /**/     _______, _______, _______, /*****/ _______, ___MOUS_THUMBR__

)
// }}}

};

layer_state_t layer_state_set_user(layer_state_t state) {
    combo_enable();
    if (layer_state_cmp(state, _GAME)) {
        combo_disable();
    }
    return state;
};
